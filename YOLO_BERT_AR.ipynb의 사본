{"cells":[{"cell_type":"markdown","metadata":{"id":"mxfBI5IOs9CT"},"source":["# 환경설정"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21600,"status":"ok","timestamp":1686204629894,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"SEULKR91gepJ","outputId":"5a1d1629-5b58-4a7f-ab17-277d6b11c217"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n","/content/drive/MyDrive/new_AR\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive', force_remount = True)\n","%cd /content/drive/MyDrive/new_AR"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZDCsGdMoLVKY"},"outputs":[],"source":["import warnings\n","warnings.filterwarnings(\"ignore\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ba5sIVmMdbVd"},"outputs":[],"source":["import os\n","path_pocketball = os.listdir('/content/drive/MyDrive/new_AR/pocket_ball/datasets/images/test')\n","path_health = os.listdir('/content/drive/MyDrive/new_AR/health_yoga/datasets/images/test')\n","path_art = os.listdir('/content/drive/MyDrive/new_AR/art/datasets/images/test')\n","path_camping = os.listdir('/content/drive/MyDrive/new_AR/camping/datasets/images/test')\n","path_athletic = os.listdir('/content/drive/MyDrive/new_AR/athletic/datasets/images/test')\n","path_medical = os.listdir('/content/drive/MyDrive/new_AR/medical/datasets/images/test')\n","path_baby = os.listdir('/content/drive/MyDrive/new_AR/baby/datasets/images/test')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6010,"status":"ok","timestamp":1686204635898,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"e1AP9OYVtZcF","outputId":"5977d10d-c39e-4e16-8194-80a0a13da630"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting ultralytics\n","  Downloading ultralytics-8.0.114-py3-none-any.whl (595 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m595.4/595.4 kB\u001b[0m \u001b[31m38.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: matplotlib>=3.2.2 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (3.7.1)\n","Requirement already satisfied: opencv-python>=4.6.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (4.7.0.72)\n","Requirement already satisfied: Pillow>=7.1.2 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (8.4.0)\n","Requirement already satisfied: PyYAML>=5.3.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (6.0)\n","Requirement already satisfied: requests>=2.23.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (2.27.1)\n","Requirement already satisfied: scipy>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (1.10.1)\n","Requirement already satisfied: torch>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (2.0.1+cu118)\n","Requirement already satisfied: torchvision>=0.8.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (0.15.2+cu118)\n","Requirement already satisfied: tqdm>=4.64.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (4.65.0)\n","Requirement already satisfied: pandas>=1.1.4 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (1.5.3)\n","Requirement already satisfied: seaborn>=0.11.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics) (0.12.2)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from ultralytics) (5.9.5)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (1.0.7)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (0.11.0)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (4.39.3)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (1.4.4)\n","Requirement already satisfied: numpy>=1.20 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (23.1)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (3.0.9)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.1.4->ultralytics) (2022.7.1)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics) (3.4)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics) (3.12.0)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics) (4.5.0)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.7.0->ultralytics) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.7.0->ultralytics) (16.0.5)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3.2.2->ultralytics) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.7.0->ultralytics) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.7.0->ultralytics) (1.3.0)\n","Installing collected packages: ultralytics\n","Successfully installed ultralytics-8.0.114\n"]}],"source":["!pip install ultralytics"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11093,"status":"ok","timestamp":1686043236696,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"NPXj-x2HDW9m","outputId":"701a054d-3b6c-423c-d8f8-ceb7570b50b3"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.29.2-py3-none-any.whl (7.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.1/7.1 MB\u001b[0m \u001b[31m53.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Collecting huggingface-hub<1.0,>=0.14.1 (from transformers)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m28.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m103.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.4.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.15.1 tokenizers-0.13.3 transformers-4.29.2\n"]}],"source":["!pip install transformers"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VoPiDBF-PriM"},"outputs":[],"source":["#객체 탐지\n","from ultralytics import YOLO\n","from PIL import Image\n","import cv2\n","\n","import pandas as pd\n","from itertools import zip_longest\n","import os\n","import pandas as pd\n","import numpy as np\n","import random\n","import time\n","import datetime\n","from tqdm import tqdm\n","from itertools import combinations\n","from google.colab import output\n","\n","import sys"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vMCEgOZkoBOh"},"outputs":[],"source":["#활동 분류\n","import tensorflow as tf\n","import torch\n","\n","from transformers import BertTokenizer\n","from transformers import BertForSequenceClassification, AdamW, BertConfig\n","from transformers import get_linear_schedule_with_warmup\n","from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler\n","from tensorflow.keras.preprocessing.sequence import pad_sequences\n","from sklearn.model_selection import train_test_split\n","\n","import pandas as pd\n","import numpy as np\n","import random\n","import time\n","import datetime\n","\n","import sys\n","import pandas as pd\n","from transformers import BertTokenizer"]},{"cell_type":"markdown","metadata":{"id":"iJoyXeVdtlHZ"},"source":["# 객체 탐지"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4fE69ltStdFJ"},"outputs":[],"source":["#모델 불러오기\n","pocketball_model = YOLO(\"pocket_ball/runs/detect/train8/weights/best.pt\")\n","health_model = YOLO(\"health_yoga/runs/detect/train4/weights/best.pt\")\n","art_model = YOLO(\"art/runs/detect/train4/weights/best.pt\")\n","medical_model = YOLO(\"medical/runs/detect/train2/weights/best.pt\")\n","baby_model = YOLO('baby/runs/detect/train/weights/best.pt')\n","athletic_model = YOLO('athletic/runs/detect/train8/weights/best.pt')\n","camping_model = YOLO('camping/runs/detect/train5/weights/best.pt')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"I2zcsbfgtnnB"},"outputs":[],"source":["#이미지 하나 넣을 떄 마다 7가지 모델에 넣고 결과를 확인해야 한다.\n","#결과를 확인하기 위한 방안\n","# 1. IOU 임계값 정한 후 이 임계값 위에 해당하는 예측 확인\n","# 2. 신뢰점수 확인\n","\n","#모델 탐지 후 위치값 반환하는 함수\n","def xywh(cate,img):\n","  path = os.path.join('/content/drive/MyDrive/new_AR/', cate)\n","  path2 = os.path.join(path, 'datasets/images/test')\n","  image = os.path.join(path2, img)\n","  results_poketball= pocketball_model.predict(source=image, conf=0.25, iou = 0.5) #신뢰점수 및 IOU 임계값 설정\n","  results_health= health_model.predict(source=image, conf=0.25, iou = 0.5)\n","  results_art = art_model.predict(source=image, conf=0.25, iou = 0.5)\n","  results_medical = medical_model.predict(source=image, conf=0.25, iou = 0.5)\n","  results_baby = baby_model.predict(source=image, conf=0.25, iou = 0.5)\n","  results_athletic = athletic_model.predict(source=image, conf=0.25, iou = 0.5)\n","  results_camping = camping_model.predict(source=image, conf=0.25, iou = 0.5)\n","\n","  output.clear()\n","\n","  #df = pd.DataFrame(columns=['xywh','conf','cls'])\n","  np.set_printoptions(precision=5)\n","  for pocketball, health, art, medical, baby, athletic, camping in zip_longest(results_poketball, results_health, results_art, results_medical, results_baby, results_athletic, results_camping, fillvalue = 0):\n","      # Detection\n","      # result.boxes.xyxy   # box with xyxy format, (N, 4)\n","      # confidence score, (N, 1)\n","      listofobject= []\n","      if pocketball.boxes.conf.numel() == 0 :\n","        pass\n","      else:\n","        pocketball_xywh = pocketball.boxes.xywh.float().tolist()\n","        pocketball_conf = pocketball.boxes.conf.float().flatten().tolist()\n","        pocketball_conf = np.round(pocketball_conf, 5).tolist()\n","        pocketball_cls = pocketball.boxes.cls.int().flatten().tolist()\n","        cate = [\"pocketball\" for _ in range(len(pocketball_cls))]\n","        pocketball = list(zip_longest(pocketball_cls, pocketball_conf, cate, pocketball_xywh))\n","        listofobject = listofobject + pocketball\n","      if health.boxes.conf.numel()==0:\n","        pass\n","      else:\n","        health_conf = health.boxes.conf.float().flatten().tolist()\n","        health_conf = np.round(health_conf, 5).tolist()\n","        health_xywh = health.boxes.xywh.float().tolist()\n","        health_cls = health.boxes.cls.int().flatten().tolist()\n","        cate = [\"health\" for _ in range(len(health_cls))]\n","        health = list(zip_longest(health_cls, health_conf, cate, health_xywh))\n","        listofobject = listofobject + health\n","      if art.boxes.conf.numel() == 0:\n","        pass\n","      else:\n","        art_conf = art.boxes.conf.float().flatten().tolist()\n","        art_conf = np.round(art_conf, 5).tolist()\n","        art_xywh = art.boxes.xywh.float().tolist()\n","        art_cls = art.boxes.cls.int().flatten().tolist()\n","        cate = [\"art\" for _ in range(len(art_cls))]\n","        art = list(zip_longest(art_cls, art_conf, cate, art_xywh))\n","        listofobject = listofobject + art\n","      if medical.boxes.conf.numel() ==0:\n","        pass\n","      else:\n","        medical_conf = medical.boxes.conf.float().flatten().tolist()\n","        medical_conf = np.round(medical_conf, 5).tolist()\n","        medical_xywh = medical.boxes.xywh.float().tolist()\n","        medical_cls = medical.boxes.cls.int().flatten().tolist()\n","        cate = [\"medical\" for _ in range(len(medical_cls))]\n","        medical = list(zip_longest(medical_cls, medical_conf, cate, medical_xywh))\n","        listofobject = listofobject + medical\n","      if baby.boxes.conf.numel() ==0:\n","        pass\n","      else:\n","        baby_conf = baby.boxes.conf.float().flatten().tolist()\n","        baby_conf = np.round(baby_conf, 5).tolist()\n","        baby_xywh = baby.boxes.xywh.float().tolist()\n","        baby_cls = baby.boxes.cls.int().flatten().tolist()\n","        cate = [\"baby\" for _ in range(len(baby_cls))]\n","        baby = list(zip_longest(baby_cls, baby_conf, cate, baby_xywh))\n","        listofobject = listofobject + baby\n","      if athletic.boxes.conf.numel() ==0:\n","        pass\n","      else:\n","        athletic_xywh = athletic.boxes.xywh.float().tolist()\n","        athletic_conf = athletic.boxes.conf.float().flatten().tolist()\n","        athletic_conf = np.round(athletic_conf, 5).tolist()\n","        athletic_cls = athletic.boxes.cls.int().flatten().tolist()\n","        cate = [\"athletic\" for _ in range(len(athletic_cls))]\n","        athletic = list(zip_longest(athletic_cls, athletic_conf, cate, athletic_xywh))\n","        listofobject = listofobject + athletic\n","      if camping.boxes.conf.numel() ==0:\n","        pass\n","      else:\n","        camping_xywh = camping.boxes.xywh.float().tolist()\n","        camping_conf = camping.boxes.conf.float().flatten().tolist()\n","        camping_conf = np.round(camping_conf, 5).tolist()\n","        camping_cls = camping.boxes.cls.int().flatten().tolist()\n","        cate = [\"camping\" for _ in range(len(camping_cls))]\n","        camping = list(zip_longest(camping_cls, camping_conf, cate, camping_xywh))\n","        listofobject = listofobject + camping\n","\n","  return listofobject\n","\n","#iou값 계해서 같은 객체 가리키는 경우 반환하는 함수\n","def IOU(box1, box2):   #중심좌표 x,y,w,h\n","  #box 좌표 x1, x2, y1, y2  좌상(x1,y1) 우하(x2,y2)\n","  box1_cor = [box1[0]-box1[2]/2, box1[0]+box1[2]/2, box1[1]+box1[3]/2 , box1[1]-box1[3]/2]\n","  box2_cor = [box2[0]-box2[2]/2, box2[0]+box2[2]/2, box2[1]+box2[3]/2 , box2[1]-box2[3]/2]\n","\n","  #box 넓이\n","  box1_area = box1[2] * box1[3]\n","  box2_area = box2[2] * box2[3]\n","\n","  #교집합의 x, y\n","\n","  intersection_x_length = max((min(box1_cor[1],box2_cor[1]) - max(box1_cor[0],box2_cor[0])),0)\n","  intersection_y_length = max((min(box1_cor[2],box2_cor[2]) - max(box1_cor[3],box2_cor[3])),0)\n","\n","  intersection = intersection_x_length * intersection_y_length\n","\n","  return intersection / (box1_area + box2_area - intersection + 1e-7)\n","\n","def get_unique_list(seq):\n","    seen = []\n","    return [x for x in seq if x not in seen and not seen.append(x)]\n","\n","def object_detection(cate, img):  #/content/drive/MyDrive/new_AR/data\n","    result_fin = []\n","    df_o= pd.DataFrame(columns = [\"골프공\",\"야구공\",\"셔틀콕\",\"테니스공\",\"탁구공\",\"푸시업바\",'헬스장갑','폼롤러','아령','악력기','줄넘기','요가링','체중계','원판','운동밴드','청진기','소프트젤형알약','임신테스트기','연고','밴드','주사기','인공눈물',\n","                                '목발','천식흡입기','약병','포셉','부항컵','타블렛형알약','캡슐형알약','구급키트','부항기','벼루','포스터물감','팔레트','당구공','초크','포켓볼삼각대','치발기',\n","                                '공갈젖꼭지','아기신발','아기손톱깎이','워터저그','아이스박스','코펠','휴대용가스버너','파이어스틱','캠핑의자','텐트팩','캠핑테이블','야전삽','전기릴선','부탄가스','손전등','cate'])\n","    for image in tqdm(img):\n","      c = []\n","      last = [] #이미지 하나\n","      xy = xywh(cate, image)\n","      combination = list(combinations(xy,2))\n","      for com in combination:\n","        if IOU(com[0][3], com[1][3]) > 0.8: #iou가 0.85 이상인 조합만 모으기\n","          c.append([com[0][:3], com[1][:3]])\n","      fin = c\n","      while True:\n","        fino = fin\n","        count = 0\n","        for com in range(len(fin)):\n","          for com2 in range(com+1, len(fin)):\n","            intersection_count = 0\n","            a = np.array(fin[com])\n","            b = np.array(fin[com2])\n","            aset = set(tuple(x) for x in a)\n","            bset = set(tuple(x) for x in b)\n","            intersection = np.array([x for x in aset & bset])\n","            if len(intersection)>=1:\n","              count += 1\n","              intersection_count+=1\n","              union = np.array([x for x in aset | bset])\n","              fin.append(union.tolist())\n","              fin.remove(fin[com])\n","              fin.remove(fin[com])\n","              break\n","            else:\n","              pass\n","        if fino==fin and count==0:\n","          break\n","      for i in fin:\n","        max = 0\n","        for j in range(len(i)):\n","          if float(i[j][1]) > max:\n","            max = float(i[j][1])\n","            max_i = [int(i[j][0]),float(i[j][1]),str(i[j][2])]\n","        last.append(max_i)\n","      result = pd.DataFrame(last, columns = ['cls','conf','cate'])\n","      result.loc[(result[\"cate\"] == \"athletic\") & (result[\"cls\"]==0), \"cls\"] = \"골프공\"\n","      result.loc[(result[\"cate\"] == \"athletic\") & (result[\"cls\"]==1), \"cls\"] = \"야구공\"\n","      result.loc[(result[\"cate\"] == \"athletic\") & (result[\"cls\"]==2), \"cls\"] = \"셔틀콕\"\n","      result.loc[(result[\"cate\"] == \"athletic\") & (result[\"cls\"]==3), \"cls\"] = \"테니스공\"\n","      result.loc[(result[\"cate\"] == \"athletic\") & (result[\"cls\"]==4), \"cls\"] = \"탁구공\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==0), \"cls\"] = \"푸시업바\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==1), \"cls\"] = \"헬스장갑\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==2), \"cls\"] = \"폼롤러\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==3), \"cls\"] = \"아령\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==4), \"cls\"] = \"악력기\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==5), \"cls\"] = \"줄넘기\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==6), \"cls\"] = \"요가링\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==7), \"cls\"] = \"체중계\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==8), \"cls\"] = \"원판\"\n","      result.loc[(result[\"cate\"] == \"health\") & (result[\"cls\"]==9), \"cls\"] = \"운동밴드\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==0), \"cls\"] = \"청진기\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==1), \"cls\"] = \"소프트젤형알약\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==2), \"cls\"] = \"임신테스트기\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==3), \"cls\"] = \"연고\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==4), \"cls\"] = \"밴드\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==5), \"cls\"] = \"주사기\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==6), \"cls\"] = \"인공눈물\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==7), \"cls\"] = \"목발\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==8), \"cls\"] = \"천식흡입기\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==9), \"cls\"] = \"약병\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==10), \"cls\"] = \"포셉\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==11), \"cls\"] = \"부항컵\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==12), \"cls\"] = \"타블렛형알약\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==13), \"cls\"] = \"캡슐형알약\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==14), \"cls\"] = \"구급키트\"\n","      result.loc[(result[\"cate\"] == \"medical\") & (result[\"cls\"]==15), \"cls\"] = \"부항기\"\n","      result.loc[(result[\"cate\"] == \"art\") & (result[\"cls\"]==0), \"cls\"] = \"벼루\"\n","      result.loc[(result[\"cate\"] == \"art\") & (result[\"cls\"]==1), \"cls\"] = \"포스터물감\"\n","      result.loc[(result[\"cate\"] == \"art\") & (result[\"cls\"]==2), \"cls\"] = \"팔레트\"\n","      result.loc[(result[\"cate\"] == \"pocketball\") & (result[\"cls\"]==0), \"cls\"] = \"당구공\"\n","      result.loc[(result[\"cate\"] == \"pocketball\") & (result[\"cls\"]==1), \"cls\"] = \"초크\"\n","      result.loc[(result[\"cate\"] == \"pocketball\") & (result[\"cls\"]==2), \"cls\"] = \"포켓볼삼각대\"\n","      result.loc[(result[\"cate\"] == \"baby\") & (result[\"cls\"]==0), \"cls\"] = \"치발기\"\n","      result.loc[(result[\"cate\"] == \"baby\") & (result[\"cls\"]==1), \"cls\"] = \"공갈젖꼭지\"\n","      result.loc[(result[\"cate\"] == \"baby\") & (result[\"cls\"]==2), \"cls\"] = \"아기신발\"\n","      result.loc[(result[\"cate\"] == \"baby\") & (result[\"cls\"]==3), \"cls\"] = \"아기손톱깎이\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==0), \"cls\"] = \"워터저그\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==1), \"cls\"] = \"아이스박스\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==2), \"cls\"] = \"코펠\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==3), \"cls\"] = \"휴대용가스버너\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==4), \"cls\"] = \"파이어스틱\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==5), \"cls\"] = \"캠핑의자\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==6), \"cls\"] = \"텐트팩\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==7), \"cls\"] = \"캠핑테이블\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==8), \"cls\"] = \"야전삽\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==9), \"cls\"] = \"전기릴선\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==10), \"cls\"] = \"부탄가스\"\n","      result.loc[(result[\"cate\"] == \"camping\") & (result[\"cls\"]==11), \"cls\"] = \"손전등\"\n","\n","      column_list = [\"골프공\",\"야구공\",\"셔틀콕\",\"테니스공\",\"탁구공\",\"푸시업바\",'헬스장갑','폼롤러','아령','악력기','줄넘기','요가링','체중계','원판','운동밴드','청진기','소프트젤형알약','임신테스트기','연고','밴드','주사기','인공눈물',\n","                                '목발','천식흡입기','약병','포셉','부항컵','타블렛형알약','캡슐형알약','구급키트','부항기','벼루','포스터물감','팔레트','당구공','초크','포켓볼삼각대','치발기',\n","                                '공갈젖꼭지','아기신발','아기손톱깎이','워터저그','아이스박스','코펠','휴대용가스버너','파이어스틱','캠핑의자','텐트팩','캠핑테이블','야전삽','전기릴선','부탄가스','손전등']\n","      for i in column_list :\n","        conf = result[['conf']].loc[(result[\"cls\"] == i)].values.tolist()\n","        result['conf'].loc[(result[\"cls\"] == i)] = str(conf)\n","\n","      result = result.drop_duplicates(subset='cls',keep='first')\n","      result = result.set_index('cls')\n","      df1 = result.drop(['cate'], axis = 1)\n","      df1 = df1.T\n","\n","      df1.reset_index(inplace = True, drop=True)\n","      df1['cate'] = cate\n","      df1['img'] = image\n","\n","      df_o = pd.concat([df_o, df1])\n","      df_o = df_o.fillna(0)\n","    return df_o"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZwpFpnASfowx"},"outputs":[],"source":["def count_value(df_line, imm):\n","    conf = []\n","    for d in df_line:\n","      conf.append(d[0])\n","    conf1 = conf.copy()\n","    for j in range(len(conf1)):\n","      if conf1[j] < imm:\n","        if len(conf)==0:\n","          conf = 0\n","          break\n","        else:\n","          conf.remove(conf1[j])\n","          if len(conf)==0:\n","            conf = 0\n","            break\n","\n","    return conf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22643,"status":"ok","timestamp":1686148603867,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"qHKJUSXk-LDI","outputId":"3ccaab66-22d6-43e5-8da2-f5c6506ded84"},"outputs":[{"name":"stderr","output_type":"stream","text":["100%|██████████| 3/3 [00:21<00:00,  7.16s/it]\n"]}],"source":["t = object_detection(\"health_yoga\", [\"833785_605.jpg\", \"833897_605.jpg\",'841244_605.jpg'])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1686148709776,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"dP0xHjL1S23k","outputId":"24cd391e-c244-4194-abaf-e81c9d5cec6e"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-473fecee-e5d7-44b1-b79c-e87c6fe42fd8\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>골프공</th>\n","      <th>야구공</th>\n","      <th>셔틀콕</th>\n","      <th>테니스공</th>\n","      <th>탁구공</th>\n","      <th>푸시업바</th>\n","      <th>헬스장갑</th>\n","      <th>폼롤러</th>\n","      <th>아령</th>\n","      <th>악력기</th>\n","      <th>...</th>\n","      <th>파이어스틱</th>\n","      <th>캠핑의자</th>\n","      <th>텐트팩</th>\n","      <th>캠핑테이블</th>\n","      <th>야전삽</th>\n","      <th>전기릴선</th>\n","      <th>부탄가스</th>\n","      <th>손전등</th>\n","      <th>cate</th>\n","      <th>img</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>[[0.87943], [0.83768]]</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>health_yoga</td>\n","      <td>833785_605.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>[[0.88108]]</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>[[0.32045]]</td>\n","      <td>health_yoga</td>\n","      <td>833897_605.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>[[0.87772], [0.88523]]</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>health_yoga</td>\n","      <td>841244_605.jpg</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3 rows × 55 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-473fecee-e5d7-44b1-b79c-e87c6fe42fd8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-473fecee-e5d7-44b1-b79c-e87c6fe42fd8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-473fecee-e5d7-44b1-b79c-e87c6fe42fd8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["   골프공  야구공  셔틀콕  테니스공  탁구공  푸시업바  헬스장갑  폼롤러                      아령  \\\n","0    0    0    0     0    0     0     0    0  [[0.87943], [0.83768]]   \n","0    0    0    0     0    0     0     0    0             [[0.88108]]   \n","0    0    0    0     0    0     0     0    0                       0   \n","\n","                      악력기  ...  파이어스틱  캠핑의자  텐트팩  캠핑테이블  야전삽  전기릴선  부탄가스  \\\n","0                     0.0  ...    0.0   0.0  0.0    0.0  0.0   0.0   0.0   \n","0                     0.0  ...    0.0   0.0  0.0    0.0  0.0   0.0   0.0   \n","0  [[0.87772], [0.88523]]  ...    0.0   0.0  0.0    0.0  0.0   0.0   0.0   \n","\n","           손전등         cate             img  \n","0            0  health_yoga  833785_605.jpg  \n","0  [[0.32045]]  health_yoga  833897_605.jpg  \n","0            0  health_yoga  841244_605.jpg  \n","\n","[3 rows x 55 columns]"]},"execution_count":54,"metadata":{},"output_type":"execute_result"}],"source":["t"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"executionInfo":{"elapsed":672,"status":"ok","timestamp":1686148805033,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"ln_nf5GBSaIy","outputId":"e5e62623-74eb-4a90-95ef-6042f09de4a3"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-072c6178-244c-404a-94a3-c88f8131c28a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>골프공</th>\n","      <th>야구공</th>\n","      <th>셔틀콕</th>\n","      <th>테니스공</th>\n","      <th>탁구공</th>\n","      <th>푸시업바</th>\n","      <th>헬스장갑</th>\n","      <th>폼롤러</th>\n","      <th>아령</th>\n","      <th>악력기</th>\n","      <th>...</th>\n","      <th>파이어스틱</th>\n","      <th>캠핑의자</th>\n","      <th>텐트팩</th>\n","      <th>캠핑테이블</th>\n","      <th>야전삽</th>\n","      <th>전기릴선</th>\n","      <th>부탄가스</th>\n","      <th>손전등</th>\n","      <th>cate</th>\n","      <th>img</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>[0.87943, 0.83768]</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>health_yoga</td>\n","      <td>833785_605.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>[0.88108]</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>health_yoga</td>\n","      <td>833897_605.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>[0.87772, 0.88523]</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>health_yoga</td>\n","      <td>841244_605.jpg</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3 rows × 55 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-072c6178-244c-404a-94a3-c88f8131c28a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-072c6178-244c-404a-94a3-c88f8131c28a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-072c6178-244c-404a-94a3-c88f8131c28a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["   골프공  야구공  셔틀콕  테니스공  탁구공  푸시업바  헬스장갑  폼롤러                  아령  \\\n","0    0    0    0     0    0     0     0    0  [0.87943, 0.83768]   \n","0    0    0    0     0    0     0     0    0           [0.88108]   \n","0    0    0    0     0    0     0     0    0                   0   \n","\n","                  악력기  ...  파이어스틱  캠핑의자  텐트팩  캠핑테이블  야전삽  전기릴선  부탄가스  손전등  \\\n","0                   0  ...      0     0    0      0    0     0     0    0   \n","0                   0  ...      0     0    0      0    0     0     0    0   \n","0  [0.87772, 0.88523]  ...      0     0    0      0    0     0     0    0   \n","\n","          cate             img  \n","0  health_yoga  833785_605.jpg  \n","0  health_yoga  833897_605.jpg  \n","0  health_yoga  841244_605.jpg  \n","\n","[3 rows x 55 columns]"]},"execution_count":58,"metadata":{},"output_type":"execute_result"}],"source":["column_list = [\"골프공\",\"야구공\",\"셔틀콕\",\"테니스공\",\"탁구공\",\"푸시업바\",'헬스장갑','폼롤러','아령','악력기','줄넘기','요가링','체중계','원판','운동밴드','청진기','소프트젤형알약','임신테스트기','연고','밴드','주사기','인공눈물',\n","                                '목발','천식흡입기','약병','포셉','부항컵','타블렛형알약','캡슐형알약','구급키트','부항기','벼루','포스터물감','팔레트','당구공','초크','포켓볼삼각대','치발기',\n","                                '공갈젖꼭지','아기신발','아기손톱깎이','워터저그','아이스박스','코펠','휴대용가스버너','파이어스틱','캠핑의자','텐트팩','캠핑테이블','야전삽','전기릴선','부탄가스','손전등']\n","t = pd.read_csv(\"ddd.csv\",index_col = 0,converters = {\"골프공\" : literal_eval,\"야구공\" : literal_eval,\"셔틀콕\" : literal_eval,\"테니스공\" : literal_eval,\"탁구공\" : literal_eval,\"푸시업바\" : literal_eval,'헬스장갑' : literal_eval,'폼롤러' : literal_eval,'아령' : literal_eval,'악력기' : literal_eval,'줄넘기' : literal_eval,'요가링' : literal_eval,'체중계' : literal_eval,'원판' : literal_eval,'운동밴드' : literal_eval,'청진기' : literal_eval,'소프트젤형알약' : literal_eval,'임신테스트기' : literal_eval,'연고' : literal_eval,'밴드' : literal_eval,'주사기' : literal_eval,'인공눈물' : literal_eval,\n","                                '목발' : literal_eval,'천식흡입기' : literal_eval,'약병' : literal_eval,'포셉' : literal_eval,'부항컵' : literal_eval,'타블렛형알약' : literal_eval,'캡슐형알약' : literal_eval,'구급키트' : literal_eval,'부항기' : literal_eval,'벼루' : literal_eval,'포스터물감' : literal_eval,'팔레트' : literal_eval,'당구공' : literal_eval,'초크' : literal_eval,'포켓볼삼각대' : literal_eval,'치발기' : literal_eval,\n","                                '공갈젖꼭지' : literal_eval,'아기신발' : literal_eval,'아기손톱깎이' : literal_eval,'워터저그' : literal_eval,'아이스박스' : literal_eval,'코펠' : literal_eval,'휴대용가스버너' : literal_eval,'파이어스틱' : literal_eval,'캠핑의자' : literal_eval,'텐트팩' : literal_eval,'캠핑테이블' : literal_eval,'야전삽' : literal_eval,'전기릴선' : literal_eval,'부탄가스' : literal_eval,'손전등' : literal_eval}) # list 값 읽어오기 (csv)\n","\n","for i in column_list:\n","  t[i] = t[i].apply(lambda a: count_value(a, 0.8) if a!=0 else 0)\n","t"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3863837,"status":"ok","timestamp":1686219011612,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"6ptGkp7VC_wW","outputId":"90715eba-1925-4978-d5c8-d24313757e97"},"outputs":[{"name":"stderr","output_type":"stream","text":["100%|██████████| 508/508 [23:56<00:00,  2.83s/it]\n"]},{"data":{"text/html":["\n","  <div id=\"df-60fcfb97-58ee-465d-8084-872b223e2a4e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>골프공</th>\n","      <th>야구공</th>\n","      <th>셔틀콕</th>\n","      <th>테니스공</th>\n","      <th>탁구공</th>\n","      <th>푸시업바</th>\n","      <th>헬스장갑</th>\n","      <th>폼롤러</th>\n","      <th>아령</th>\n","      <th>악력기</th>\n","      <th>...</th>\n","      <th>파이어스틱</th>\n","      <th>캠핑의자</th>\n","      <th>텐트팩</th>\n","      <th>캠핑테이블</th>\n","      <th>야전삽</th>\n","      <th>전기릴선</th>\n","      <th>부탄가스</th>\n","      <th>손전등</th>\n","      <th>cate</th>\n","      <th>img</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>camping</td>\n","      <td>1742533_616.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>[[0.85142]]</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>camping</td>\n","      <td>1745232_616.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>camping</td>\n","      <td>1978786_616.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>camping</td>\n","      <td>1846489_616.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>camping</td>\n","      <td>2135747_616.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1664948_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1664439_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1448317_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1512480_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1518730_598.jpg</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3708 rows × 55 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-60fcfb97-58ee-465d-8084-872b223e2a4e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-60fcfb97-58ee-465d-8084-872b223e2a4e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-60fcfb97-58ee-465d-8084-872b223e2a4e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["    골프공  야구공  셔틀콕 테니스공  탁구공 푸시업바 헬스장갑  폼롤러   아령  악력기  ...        파이어스틱 캠핑의자  \\\n","0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  ...            0  0.0   \n","0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  ...  [[0.85142]]  0.0   \n","0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  ...            0  0.0   \n","0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  ...            0  0.0   \n","0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  ...            0  0.0   \n","..  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...          ...  ...   \n","0     0    0    0    0    0  0.0    0  0.0  0.0    0  ...            0  0.0   \n","0     0    0    0    0    0  0.0    0  0.0  0.0    0  ...            0  0.0   \n","0     0    0    0    0    0  0.0    0  0.0  0.0    0  ...            0  0.0   \n","0     0    0    0    0    0  0.0    0  0.0  0.0    0  ...            0  0.0   \n","0     0    0    0    0    0  0.0    0  0.0  0.0    0  ...            0  0.0   \n","\n","    텐트팩 캠핑테이블  야전삽 전기릴선 부탄가스  손전등     cate              img  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  camping  1742533_616.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  camping  1745232_616.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  camping  1978786_616.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  camping  1846489_616.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  camping  2135747_616.jpg  \n","..  ...   ...  ...  ...  ...  ...      ...              ...  \n","0     0   0.0  0.0  0.0    0    0     baby  1664948_598.jpg  \n","0     0   0.0  0.0  0.0    0    0     baby  1664439_598.jpg  \n","0     0   0.0  0.0  0.0    0    0     baby  1448317_598.jpg  \n","0     0   0.0  0.0  0.0    0    0     baby  1512480_598.jpg  \n","0     0   0.0  0.0  0.0    0    0     baby  1518730_598.jpg  \n","\n","[3708 rows x 55 columns]"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["column_list = [\"골프공\",\"야구공\",\"셔틀콕\",\"테니스공\",\"탁구공\",\"푸시업바\",'헬스장갑','폼롤러','아령','악력기','줄넘기','요가링','체중계','원판','운동밴드','청진기','소프트젤형알약','임신테스트기','연고','밴드','주사기','인공눈물',\n","                                '목발','천식흡입기','약병','포셉','부항컵','타블렛형알약','캡슐형알약','구급키트','부항기','벼루','포스터물감','팔레트','당구공','초크','포켓볼삼각대','치발기',\n","                                '공갈젖꼭지','아기신발','아기손톱깎이','워터저그','아이스박스','코펠','휴대용가스버너','파이어스틱','캠핑의자','텐트팩','캠핑테이블','야전삽','전기릴선','부탄가스','손전등']\n","#path_pocketball = os.listdir('/content/drive/MyDrive/new_AR/pocket_ball/datasets/images/test')\n","#path_health = os.listdir('/content/drive/MyDrive/new_AR/health_yoga/datasets/images/test')\n","#path_art = os.listdir('/content/drive/MyDrive/new_AR/art/datasets/images/test')\n","path_camping = os.listdir('/content/drive/MyDrive/new_AR/camping/datasets/images/test')\n","path_athletic = os.listdir('/content/drive/MyDrive/new_AR/athletic/datasets/images/test')\n","path_medical = os.listdir('/content/drive/MyDrive/new_AR/medical/datasets/images/test')\n","path_baby = os.listdir('/content/drive/MyDrive/new_AR/baby/datasets/images/test')\n","\n","test_data = pd.DataFrame(columns = column_list)\n","\n","#test_data_pocketball = object_detection(\"pocket_ball\", path_pocketball)\n","#test_data = pd.concat([test_data, test_data_pocketball], axis = 0)\n","#test_data_health= object_detection(\"health_yoga\",path_health)\n","#test_data = pd.concat([test_data, test_data_health], axis = 0)\n","#test_data_art= object_detection(\"art\",path_art)\n","#test_data = pd.concat([test_data, test_data_art], axis = 0)\n","test_data_camping= object_detection(\"camping\",path_camping)\n","test_data = pd.concat([test_data, test_data_camping], axis = 0)\n","test_data_athletic= object_detection(\"athletic\",path_athletic)\n","test_data = pd.concat([test_data, test_data_athletic], axis = 0)\n","test_data_medical= object_detection(\"medical\",path_medical)\n","test_data = pd.concat([test_data, test_data_medical], axis = 0)\n","test_data_baby= object_detection(\"baby\",path_baby)\n","test_data = pd.concat([test_data, test_data_baby], axis = 0)\n","\n","test_data"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":468},"executionInfo":{"elapsed":31237,"status":"ok","timestamp":1686211075509,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"qi50SAO2VpJ3","outputId":"ac994675-608f-431b-a1cd-74961927352f"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-ba678afe-aa22-434f-900c-481af273e94f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>골프공</th>\n","      <th>야구공</th>\n","      <th>셔틀콕</th>\n","      <th>테니스공</th>\n","      <th>탁구공</th>\n","      <th>푸시업바</th>\n","      <th>헬스장갑</th>\n","      <th>폼롤러</th>\n","      <th>아령</th>\n","      <th>악력기</th>\n","      <th>...</th>\n","      <th>파이어스틱</th>\n","      <th>캠핑의자</th>\n","      <th>텐트팩</th>\n","      <th>캠핑테이블</th>\n","      <th>야전삽</th>\n","      <th>전기릴선</th>\n","      <th>부탄가스</th>\n","      <th>손전등</th>\n","      <th>cate</th>\n","      <th>img</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>1945514_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>845874_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2203529_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>[[0.91535]]</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2204093_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>[[0.89994]]</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2243011_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>art</td>\n","      <td>1597197_624.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>art</td>\n","      <td>1276126_624.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>art</td>\n","      <td>1601832_624.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>art</td>\n","      <td>1404244_624.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>art</td>\n","      <td>1415501_624.jpg</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1573 rows × 55 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ba678afe-aa22-434f-900c-481af273e94f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ba678afe-aa22-434f-900c-481af273e94f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ba678afe-aa22-434f-900c-481af273e94f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["    골프공  야구공  셔틀콕 테니스공          탁구공 푸시업바 헬스장갑  폼롤러   아령  악력기  ... 파이어스틱 캠핑의자  \\\n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0  [[0.91535]]  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0  [[0.89994]]  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","..  ...  ...  ...  ...          ...  ...  ...  ...  ...  ...  ...   ...  ...   \n","0   0.0    0    0    0          0.0  0.0    0    0    0    0  ...   0.0  0.0   \n","0   0.0    0    0    0          0.0  0.0    0    0    0    0  ...   0.0  0.0   \n","0   0.0    0    0    0          0.0  0.0    0    0    0    0  ...   0.0  0.0   \n","0   0.0    0    0    0          0.0  0.0    0    0    0    0  ...   0.0  0.0   \n","0   0.0    0    0    0          0.0  0.0    0    0    0    0  ...   0.0  0.0   \n","\n","    텐트팩 캠핑테이블  야전삽 전기릴선 부탄가스  손전등         cate              img  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  1945514_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball   845874_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2203529_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2204093_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2243011_595.jpg  \n","..  ...   ...  ...  ...  ...  ...          ...              ...  \n","0     0   0.0  0.0  0.0    0    0          art  1597197_624.jpg  \n","0     0   0.0  0.0  0.0    0    0          art  1276126_624.jpg  \n","0     0   0.0  0.0  0.0    0    0          art  1601832_624.jpg  \n","0     0   0.0  0.0  0.0    0    0          art  1404244_624.jpg  \n","0     0   0.0  0.0  0.0    0    0          art  1415501_624.jpg  \n","\n","[1573 rows x 55 columns]"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["test_data"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":961,"status":"ok","timestamp":1686211096774,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"1scbAXp8yn0G","outputId":"6e769741-7f6c-4b47-9230-081aa92b2c31"},"outputs":[{"name":"stderr","output_type":"stream","text":["ERROR:root:Internal Python error in the inspect module.\n","Below is the traceback from this internal error.\n","\n","ERROR:root:Internal Python error in the inspect module.\n","Below is the traceback from this internal error.\n","\n","ERROR:root:Internal Python error in the inspect module.\n","Below is the traceback from this internal error.\n","\n"]},{"name":"stdout","output_type":"stream","text":["Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3553, in run_code\n","    exec(code_obj, self.user_global_ns, self.user_ns)\n","  File \"<ipython-input-14-246bc4a4669f>\", line 2, in <cell line: 2>\n","    test_data.to_csv(\"test_data_weight_count80_2.csv\")\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\", line 211, in wrapper\n","    return func(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/core/generic.py\", line 3720, in to_csv\n","    return DataFrameRenderer(formatter).to_csv(\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\", line 211, in wrapper\n","    return func(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/formats/format.py\", line 1189, in to_csv\n","    csv_formatter.save()\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/formats/csvs.py\", line 241, in save\n","    with get_handle(\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\", line 734, in get_handle\n","    check_parent_directory(str(handle))\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\", line 596, in check_parent_directory\n","    if not parent.is_dir():\n","  File \"/usr/lib/python3.10/pathlib.py\", line 1305, in is_dir\n","    return S_ISDIR(self.stat().st_mode)\n","  File \"/usr/lib/python3.10/pathlib.py\", line 1097, in stat\n","    return self._accessor.stat(self, follow_symlinks=follow_symlinks)\n","OSError: [Errno 107] Transport endpoint is not connected: '.'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'OSError' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1101, in get_records\n","    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 248, in wrapped\n","    return f(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 281, in _fixed_getinnerframes\n","    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))\n","  File \"/usr/lib/python3.10/inspect.py\", line 1662, in getinnerframes\n","    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)\n","  File \"/usr/lib/python3.10/inspect.py\", line 1620, in getframeinfo\n","    filename = getsourcefile(frame) or getfile(frame)\n","  File \"/usr/lib/python3.10/inspect.py\", line 829, in getsourcefile\n","    module = getmodule(object, filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 861, in getmodule\n","    file = getabsfile(object, _filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 845, in getabsfile\n","    return os.path.normcase(os.path.abspath(_filename))\n","  File \"/usr/lib/python3.10/posixpath.py\", line 384, in abspath\n","    cwd = os.getcwd()\n","OSError: [Errno 107] Transport endpoint is not connected\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3553, in run_code\n","    exec(code_obj, self.user_global_ns, self.user_ns)\n","  File \"<ipython-input-14-246bc4a4669f>\", line 2, in <cell line: 2>\n","    test_data.to_csv(\"test_data_weight_count80_2.csv\")\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\", line 211, in wrapper\n","    return func(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/core/generic.py\", line 3720, in to_csv\n","    return DataFrameRenderer(formatter).to_csv(\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\", line 211, in wrapper\n","    return func(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/formats/format.py\", line 1189, in to_csv\n","    csv_formatter.save()\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/formats/csvs.py\", line 241, in save\n","    with get_handle(\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\", line 734, in get_handle\n","    check_parent_directory(str(handle))\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\", line 596, in check_parent_directory\n","    if not parent.is_dir():\n","  File \"/usr/lib/python3.10/pathlib.py\", line 1305, in is_dir\n","    return S_ISDIR(self.stat().st_mode)\n","  File \"/usr/lib/python3.10/pathlib.py\", line 1097, in stat\n","    return self._accessor.stat(self, follow_symlinks=follow_symlinks)\n","OSError: [Errno 107] Transport endpoint is not connected: '.'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'OSError' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3473, in run_ast_nodes\n","    if (await self.run_code(code, result,  async_=asy)):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3575, in run_code\n","    self.showtraceback(running_compiled_code=True)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2101, in showtraceback\n","    stb = self.InteractiveTB.structured_traceback(etype,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1367, in structured_traceback\n","    return FormattedTB.structured_traceback(\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1267, in structured_traceback\n","    return VerboseTB.structured_traceback(\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1124, in structured_traceback\n","    formatted_exception = self.format_exception_as_a_whole(etype, evalue, etb, number_of_lines_of_context,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1082, in format_exception_as_a_whole\n","    last_unique, recursion_repeat = find_recursion(orig_etype, evalue, records)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 382, in find_recursion\n","    return len(records), 0\n","TypeError: object of type 'NoneType' has no len()\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'TypeError' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1101, in get_records\n","    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 248, in wrapped\n","    return f(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 281, in _fixed_getinnerframes\n","    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))\n","  File \"/usr/lib/python3.10/inspect.py\", line 1662, in getinnerframes\n","    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)\n","  File \"/usr/lib/python3.10/inspect.py\", line 1620, in getframeinfo\n","    filename = getsourcefile(frame) or getfile(frame)\n","  File \"/usr/lib/python3.10/inspect.py\", line 829, in getsourcefile\n","    module = getmodule(object, filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 861, in getmodule\n","    file = getabsfile(object, _filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 845, in getabsfile\n","    return os.path.normcase(os.path.abspath(_filename))\n","  File \"/usr/lib/python3.10/posixpath.py\", line 384, in abspath\n","    cwd = os.getcwd()\n","OSError: [Errno 107] Transport endpoint is not connected\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3553, in run_code\n","    exec(code_obj, self.user_global_ns, self.user_ns)\n","  File \"<ipython-input-14-246bc4a4669f>\", line 2, in <cell line: 2>\n","    test_data.to_csv(\"test_data_weight_count80_2.csv\")\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\", line 211, in wrapper\n","    return func(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/core/generic.py\", line 3720, in to_csv\n","    return DataFrameRenderer(formatter).to_csv(\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\", line 211, in wrapper\n","    return func(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/formats/format.py\", line 1189, in to_csv\n","    csv_formatter.save()\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/formats/csvs.py\", line 241, in save\n","    with get_handle(\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\", line 734, in get_handle\n","    check_parent_directory(str(handle))\n","  File \"/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\", line 596, in check_parent_directory\n","    if not parent.is_dir():\n","  File \"/usr/lib/python3.10/pathlib.py\", line 1305, in is_dir\n","    return S_ISDIR(self.stat().st_mode)\n","  File \"/usr/lib/python3.10/pathlib.py\", line 1097, in stat\n","    return self._accessor.stat(self, follow_symlinks=follow_symlinks)\n","OSError: [Errno 107] Transport endpoint is not connected: '.'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'OSError' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3473, in run_ast_nodes\n","    if (await self.run_code(code, result,  async_=asy)):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3575, in run_code\n","    self.showtraceback(running_compiled_code=True)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2101, in showtraceback\n","    stb = self.InteractiveTB.structured_traceback(etype,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1367, in structured_traceback\n","    return FormattedTB.structured_traceback(\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1267, in structured_traceback\n","    return VerboseTB.structured_traceback(\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1124, in structured_traceback\n","    formatted_exception = self.format_exception_as_a_whole(etype, evalue, etb, number_of_lines_of_context,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1082, in format_exception_as_a_whole\n","    last_unique, recursion_repeat = find_recursion(orig_etype, evalue, records)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 382, in find_recursion\n","    return len(records), 0\n","TypeError: object of type 'NoneType' has no len()\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'TypeError' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3030, in _run_cell\n","    return runner(coro)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/async_helpers.py\", line 78, in _pseudo_sync_runner\n","    coro.send(None)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3257, in run_cell_async\n","    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3492, in run_ast_nodes\n","    self.showtraceback()\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2101, in showtraceback\n","    stb = self.InteractiveTB.structured_traceback(etype,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1367, in structured_traceback\n","    return FormattedTB.structured_traceback(\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1267, in structured_traceback\n","    return VerboseTB.structured_traceback(\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1142, in structured_traceback\n","    formatted_exceptions += self.format_exception_as_a_whole(etype, evalue, etb, lines_of_context,\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1082, in format_exception_as_a_whole\n","    last_unique, recursion_repeat = find_recursion(orig_etype, evalue, records)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 382, in find_recursion\n","    return len(records), 0\n","TypeError: object of type 'NoneType' has no len()\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'TypeError' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1101, in get_records\n","    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 248, in wrapped\n","    return f(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 281, in _fixed_getinnerframes\n","    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))\n","  File \"/usr/lib/python3.10/inspect.py\", line 1662, in getinnerframes\n","    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)\n","  File \"/usr/lib/python3.10/inspect.py\", line 1620, in getframeinfo\n","    filename = getsourcefile(frame) or getfile(frame)\n","  File \"/usr/lib/python3.10/inspect.py\", line 829, in getsourcefile\n","    module = getmodule(object, filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 861, in getmodule\n","    file = getabsfile(object, _filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 845, in getabsfile\n","    return os.path.normcase(os.path.abspath(_filename))\n","  File \"/usr/lib/python3.10/posixpath.py\", line 384, in abspath\n","    cwd = os.getcwd()\n","OSError: [Errno 107] Transport endpoint is not connected\n"]}],"source":["test_data = test_data.reset_index(drop = True)\n","test_data.to_csv(\"test_data_weight_count80_1.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":485},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1686146347859,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"PaoHCSESMb7P","outputId":"d96dfef2-8f5c-454d-9112-b4ebbf2e013b"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-cd39c5f4-7507-4930-98bd-7d3bf06009bc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>골프공</th>\n","      <th>야구공</th>\n","      <th>셔틀콕</th>\n","      <th>테니스공</th>\n","      <th>탁구공</th>\n","      <th>푸시업바</th>\n","      <th>헬스장갑</th>\n","      <th>폼롤러</th>\n","      <th>아령</th>\n","      <th>악력기</th>\n","      <th>...</th>\n","      <th>파이어스틱</th>\n","      <th>캠핑의자</th>\n","      <th>텐트팩</th>\n","      <th>캠핑테이블</th>\n","      <th>야전삽</th>\n","      <th>전기릴선</th>\n","      <th>부탄가스</th>\n","      <th>손전등</th>\n","      <th>cate</th>\n","      <th>img</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>1945514_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>845874_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2203529_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2204093_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>[[0.89994]]</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2243011_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1664948_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1664439_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1448317_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1512480_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1518730_598.jpg</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5281 rows × 55 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cd39c5f4-7507-4930-98bd-7d3bf06009bc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-cd39c5f4-7507-4930-98bd-7d3bf06009bc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-cd39c5f4-7507-4930-98bd-7d3bf06009bc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["    골프공  야구공  셔틀콕 테니스공          탁구공 푸시업바 헬스장갑  폼롤러   아령  악력기  ... 파이어스틱 캠핑의자  \\\n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","0   0.0  0.0  0.0  0.0  [[0.89994]]  0.0  0.0  0.0  0.0  0.0  ...   0.0  0.0   \n","..  ...  ...  ...  ...          ...  ...  ...  ...  ...  ...  ...   ...  ...   \n","0   0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0  0.0   \n","0   0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0  0.0   \n","0   0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0  0.0   \n","0   0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0  0.0   \n","0   0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0  0.0   \n","\n","    텐트팩 캠핑테이블  야전삽 전기릴선 부탄가스  손전등         cate              img  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  1945514_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball   845874_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2203529_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2204093_595.jpg  \n","0   0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2243011_595.jpg  \n","..  ...   ...  ...  ...  ...  ...          ...              ...  \n","0     0   0.0  0.0  0.0    0    0         baby  1664948_598.jpg  \n","0     0   0.0  0.0  0.0    0    0         baby  1664439_598.jpg  \n","0     0   0.0  0.0  0.0    0    0         baby  1448317_598.jpg  \n","0     0   0.0  0.0  0.0    0    0         baby  1512480_598.jpg  \n","0     0   0.0  0.0  0.0    0    0         baby  1518730_598.jpg  \n","\n","[5281 rows x 55 columns]"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["w1 = pd.read_csv(\"test_data_count1.csv\", index_col = 0)\n","w2 = pd.read_csv(\"test_data_count2.csv\", index_col = 0)\n","w = pd.concat([w1,w2], axis = 0)\n","w"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":485},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1686146351802,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"OoiQzP1UNOKG","outputId":"1ac09e81-247d-4a0f-ef8d-45403a7aaf0a"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-ff9074ba-0b45-424e-a4c3-7ef044b78d8e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>골프공</th>\n","      <th>야구공</th>\n","      <th>셔틀콕</th>\n","      <th>테니스공</th>\n","      <th>탁구공</th>\n","      <th>푸시업바</th>\n","      <th>헬스장갑</th>\n","      <th>폼롤러</th>\n","      <th>아령</th>\n","      <th>악력기</th>\n","      <th>...</th>\n","      <th>파이어스틱</th>\n","      <th>캠핑의자</th>\n","      <th>텐트팩</th>\n","      <th>캠핑테이블</th>\n","      <th>야전삽</th>\n","      <th>전기릴선</th>\n","      <th>부탄가스</th>\n","      <th>손전등</th>\n","      <th>cate</th>\n","      <th>img</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>1945514_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>845874_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2203529_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2204093_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>[[0.89994]]</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>pocket_ball</td>\n","      <td>2243011_595.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5276</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1664948_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>5277</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1664439_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>5278</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1448317_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>5279</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1512480_598.jpg</td>\n","    </tr>\n","    <tr>\n","      <th>5280</th>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>baby</td>\n","      <td>1518730_598.jpg</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5281 rows × 55 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ff9074ba-0b45-424e-a4c3-7ef044b78d8e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ff9074ba-0b45-424e-a4c3-7ef044b78d8e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ff9074ba-0b45-424e-a4c3-7ef044b78d8e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["      골프공  야구공  셔틀콕 테니스공          탁구공 푸시업바 헬스장갑  폼롤러   아령  악력기  ... 파이어스틱  \\\n","0     0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0   \n","1     0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0   \n","2     0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0   \n","3     0.0  0.0  0.0  0.0          0.0  0.0  0.0  0.0  0.0  0.0  ...   0.0   \n","4     0.0  0.0  0.0  0.0  [[0.89994]]  0.0  0.0  0.0  0.0  0.0  ...   0.0   \n","...   ...  ...  ...  ...          ...  ...  ...  ...  ...  ...  ...   ...   \n","5276  0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0   \n","5277  0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0   \n","5278  0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0   \n","5279  0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0   \n","5280  0.0    0    0    0            0  0.0    0  0.0  0.0    0  ...     0   \n","\n","     캠핑의자  텐트팩 캠핑테이블  야전삽 전기릴선 부탄가스  손전등         cate              img  \n","0     0.0  0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  1945514_595.jpg  \n","1     0.0  0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball   845874_595.jpg  \n","2     0.0  0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2203529_595.jpg  \n","3     0.0  0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2204093_595.jpg  \n","4     0.0  0.0   0.0  0.0  0.0  0.0  0.0  pocket_ball  2243011_595.jpg  \n","...   ...  ...   ...  ...  ...  ...  ...          ...              ...  \n","5276  0.0    0   0.0  0.0  0.0    0    0         baby  1664948_598.jpg  \n","5277  0.0    0   0.0  0.0  0.0    0    0         baby  1664439_598.jpg  \n","5278  0.0    0   0.0  0.0  0.0    0    0         baby  1448317_598.jpg  \n","5279  0.0    0   0.0  0.0  0.0    0    0         baby  1512480_598.jpg  \n","5280  0.0    0   0.0  0.0  0.0    0    0         baby  1518730_598.jpg  \n","\n","[5281 rows x 55 columns]"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["w = w.reset_index(drop = True)\n","w"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dOuwqnN0MuN2"},"outputs":[],"source":["w.to_csv('test_data_weight_count90.csv')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F-OywW7vrNtG"},"outputs":[],"source":["def preprocessing(df_line):\n","  maxx = max(df_line)\n","  return maxx"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z8dmAuO0rYpP"},"outputs":[],"source":["for i in column_list:\n","    data[i] = data[i].apply(lambda a: preprocessing(a) if a!=0 else 0)\n","data.to_csv(\"classifier85.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xn5-YqEvflce"},"outputs":[],"source":["from ast import literal_eval\n","threshold = [0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95]\n","column_list = [\"골프공\",\"야구공\",\"셔틀콕\",\"테니스공\",\"탁구공\",\"푸시업바\",'헬스장갑','폼롤러','아령','악력기','줄넘기','요가링','체중계','원판','운동밴드','청진기','소프트젤형알약','임신테스트기','연고','밴드','주사기','인공눈물',\n","                                '목발','천식흡입기','약병','포셉','부항컵','타블렛형알약','캡슐형알약','구급키트','부항기','벼루','포스터물감','팔레트','당구공','초크','포켓볼삼각대','치발기',\n","                                '공갈젖꼭지','아기신발','아기손톱깎이','워터저그','아이스박스','코펠','휴대용가스버너','파이어스틱','캠핑의자','텐트팩','캠핑테이블','야전삽','전기릴선','부탄가스','손전등']\n","for t in threshold:\n","  data = pd.read_csv(\"test_data_weight_count90.csv\", index_col = 0, converters = {\"골프공\" : literal_eval,\"야구공\" : literal_eval,\"셔틀콕\" : literal_eval,\"테니스공\" : literal_eval,\"탁구공\" : literal_eval,\"푸시업바\" : literal_eval,'헬스장갑' : literal_eval,'폼롤러' : literal_eval,'아령' : literal_eval,'악력기' : literal_eval,'줄넘기' : literal_eval,'요가링' : literal_eval,'체중계' : literal_eval,'원판' : literal_eval,'운동밴드' : literal_eval,'청진기' : literal_eval,'소프트젤형알약' : literal_eval,'임신테스트기' : literal_eval,'연고' : literal_eval,'밴드' : literal_eval,'주사기' : literal_eval,'인공눈물' : literal_eval,\n","                                '목발' : literal_eval,'천식흡입기' : literal_eval,'약병' : literal_eval,'포셉' : literal_eval,'부항컵' : literal_eval,'타블렛형알약' : literal_eval,'캡슐형알약' : literal_eval,'구급키트' : literal_eval,'부항기' : literal_eval,'벼루' : literal_eval,'포스터물감' : literal_eval,'팔레트' : literal_eval,'당구공' : literal_eval,'초크' : literal_eval,'포켓볼삼각대' : literal_eval,'치발기' : literal_eval,\n","                                '공갈젖꼭지' : literal_eval,'아기신발' : literal_eval,'아기손톱깎이' : literal_eval,'워터저그' : literal_eval,'아이스박스' : literal_eval,'코펠' : literal_eval,'휴대용가스버너' : literal_eval,'파이어스틱' : literal_eval,'캠핑의자' : literal_eval,'텐트팩' : literal_eval,'캠핑테이블' : literal_eval,'야전삽' : literal_eval,'전기릴선' : literal_eval,'부탄가스' : literal_eval,'손전등' : literal_eval}) # list 값 읽어오기 (csv)\n","  filename = \"test_data_count80_\"+str(t)+\".csv\"\n","  for i in column_list:\n","    data[i] = data[i].apply(lambda a: count_value(a, t) if a!=0 else 0)\n","  data.to_csv(filename)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":112},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1685960757030,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"BhqnSE9r1p2I","outputId":"74b00859-0f7d-42f7-abf4-afb793756643"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-d27ada88-1265-4a6b-a38c-8214e3842c21\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>a</th>\n","      <th>b</th>\n","      <th>c</th>\n","      <th>d</th>\n","      <th>e</th>\n","      <th>cate</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.9</td>\n","      <td>0.2</td>\n","      <td>0.3</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>y</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.9</td>\n","      <td>0.0</td>\n","      <td>0.1</td>\n","      <td>0</td>\n","      <td>0.8</td>\n","      <td>k</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d27ada88-1265-4a6b-a38c-8214e3842c21')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d27ada88-1265-4a6b-a38c-8214e3842c21 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d27ada88-1265-4a6b-a38c-8214e3842c21');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     a    b    c  d    e cate\n","0  0.9  0.2  0.3  0  0.0    y\n","0  0.9  0.0  0.1  0  0.8    k"]},"execution_count":118,"metadata":{},"output_type":"execute_result"}],"source":["import pandas as pd\n","df_o= pd.DataFrame(columns = [\"a\",'b','c','d','e','cate'])\n","\n","df1 = pd.DataFrame({\n","    \"cls\" :[\"a\",'b','c'],\n","    \"conf\" : [0.9, 0.2, 0.3],\n","    \"cate\" : [\"y\",'y','y']\n","})\n","df1 = df1.set_index('cls')\n","cate1 = df1['cate'][0]\n","df1 = df1.drop(['cate'], axis = 1)\n","df1 = df1.T\n","\n","df1.reset_index(inplace = True, drop=True)\n","df1['cate'] = cate1\n","\n","\n","\n","df2 = pd.DataFrame({\n","    \"cls\" :[\"a\",'c','e'],\n","    \"conf\" : [0.9, 0.1, 0.8],\n","    \"cate\":['k','k','k']\n","})\n","df2 = df2.set_index('cls')\n","cate2 = df2['cate'][0]\n","df2 = df2.drop(['cate'], axis = 1)\n","df2 = df2.T\n","\n","df2.reset_index(inplace = True, drop=True)\n","df2['cate'] = cate2\n","df_o = pd.concat([df_o, df1])\n","#df_o = df_o.append(df1, sort = False, ignore_index = True)\n","#df_o = df_o.append(df2, sort = False, ignore_index = True)\n","df_o = pd.concat([df_o, df2])\n","#df_o = df_o.drop('cls', axis = 1)\n","df_o = df_o.fillna(0)\n","df_o"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":442},"executionInfo":{"elapsed":466661,"status":"ok","timestamp":1685506448293,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"WEzwAx8IzVU3","outputId":"7b26b145-9ecd-4a33-c24c-f060f55b3940"},"outputs":[{"name":"stderr","output_type":"stream","text":["100%|██████████| 100/100 [07:46<00:00,  4.66s/it]\n"]},{"data":{"text/html":["\n","  <div id=\"df-7daf3f30-4a24-4532-a6a2-ccba9b476d76\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>objects</th>\n","      <th>labels</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>당구공 초크 초크</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>당구공 당구공 당구공</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>초크 초크 초크</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td></td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td></td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>95</th>\n","      <td>당구공 타블렛형 알약 타블렛형 알약</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>96</th>\n","      <td>공갈젖꼭지 초크</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>97</th>\n","      <td>당구공 초크 당구공 타블렛형 알약</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>98</th>\n","      <td>초크 초크</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>99</th>\n","      <td>당구공</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>100 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7daf3f30-4a24-4532-a6a2-ccba9b476d76')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7daf3f30-4a24-4532-a6a2-ccba9b476d76 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7daf3f30-4a24-4532-a6a2-ccba9b476d76');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                objects       labels\n","0             당구공 초크 초크  pocket_ball\n","1           당구공 당구공 당구공  pocket_ball\n","2              초크 초크 초크  pocket_ball\n","3                        pocket_ball\n","4                        pocket_ball\n","..                  ...          ...\n","95  당구공 타블렛형 알약 타블렛형 알약  pocket_ball\n","96             공갈젖꼭지 초크  pocket_ball\n","97   당구공 초크 당구공 타블렛형 알약  pocket_ball\n","98                초크 초크  pocket_ball\n","99                  당구공  pocket_ball\n","\n","[100 rows x 2 columns]"]},"execution_count":52,"metadata":{},"output_type":"execute_result"}],"source":["path_pocketball = os.listdir('/content/drive/MyDrive/new_AR/data/pocket_ball')\n","test_data_pocketball = pd.DataFrame(object_detection(\"pocket_ball\", path_pocketball), columns = ['objects','labels'])\n","test_data_pocketball"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jyJarH-wGrwz"},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"-eg0Fn4_s_O7"},"source":["# 데이터 불러와서 전처리 (train)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":1978,"status":"ok","timestamp":1685863538688,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"3FAOqkiSYlo3","outputId":"f04f7e43-2060-4be8-d886-c4f7258ea44c"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-4d24fe73-192c-4442-a7bd-b0caab09ff69\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>objects</th>\n","      <th>labels</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>소프트젤형 알약 헬스장갑</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>당구공 당구공 당구공</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>초크 초크 초크</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>NaN</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>구급 키트 초크 당구공</td>\n","      <td>pocket_ball</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>776</th>\n","      <td>당구공 공갈젖꼭지</td>\n","      <td>athletic</td>\n","    </tr>\n","    <tr>\n","      <th>777</th>\n","      <td>팔레트</td>\n","      <td>athletic</td>\n","    </tr>\n","    <tr>\n","      <th>778</th>\n","      <td>탁구공</td>\n","      <td>athletic</td>\n","    </tr>\n","    <tr>\n","      <th>779</th>\n","      <td>초크</td>\n","      <td>athletic</td>\n","    </tr>\n","    <tr>\n","      <th>780</th>\n","      <td>NaN</td>\n","      <td>athletic</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>6318 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4d24fe73-192c-4442-a7bd-b0caab09ff69')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4d24fe73-192c-4442-a7bd-b0caab09ff69 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4d24fe73-192c-4442-a7bd-b0caab09ff69');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["           objects       labels\n","0    소프트젤형 알약 헬스장갑  pocket_ball\n","1      당구공 당구공 당구공  pocket_ball\n","2         초크 초크 초크  pocket_ball\n","3              NaN  pocket_ball\n","4     구급 키트 초크 당구공  pocket_ball\n","..             ...          ...\n","776      당구공 공갈젖꼭지     athletic\n","777            팔레트     athletic\n","778            탁구공     athletic\n","779             초크     athletic\n","780            NaN     athletic\n","\n","[6318 rows x 2 columns]"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["device = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')\n","#data 읽어오기\n","data1 = pd.read_csv(\"test_data_camping.csv\",  index_col=0)\n","data2 = pd.read_csv(\"test_data_baby.csv\", index_col = 0)\n","data3 = pd.read_csv(\"test_data_athletic.csv\", index_col = 0)\n","\n","data = pd.concat([data1, data2], axis=0)\n","data = pd.concat([data, data3], axis = 0)\n","data"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1685863538688,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"JdFOJARtsx6e","outputId":"87bba460-2a3e-4971-bcc4-d0710e141b52"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-49c76a15-d517-4e92-a6af-2c6336def825\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>objects</th>\n","      <th>labels</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>소프트젤형 알약 헬스장갑</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>당구공 당구공 당구공</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>초크 초크 초크</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>NaN</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>구급 키트 초크 당구공</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>776</th>\n","      <td>당구공 공갈젖꼭지</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>777</th>\n","      <td>팔레트</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>778</th>\n","      <td>탁구공</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>779</th>\n","      <td>초크</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>780</th>\n","      <td>NaN</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>6318 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-49c76a15-d517-4e92-a6af-2c6336def825')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-49c76a15-d517-4e92-a6af-2c6336def825 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-49c76a15-d517-4e92-a6af-2c6336def825');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["           objects labels\n","0    소프트젤형 알약 헬스장갑      5\n","1      당구공 당구공 당구공      5\n","2         초크 초크 초크      5\n","3              NaN      5\n","4     구급 키트 초크 당구공      5\n","..             ...    ...\n","776      당구공 공갈젖꼭지      1\n","777            팔레트      1\n","778            탁구공      1\n","779             초크      1\n","780            NaN      1\n","\n","[6318 rows x 2 columns]"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["data.loc[(data[\"labels\"] == \"art\"), \"labels\"] = 0\n","data.loc[(data[\"labels\"] == \"athletic\"), \"labels\"] = 1\n","data.loc[(data[\"labels\"] == \"baby\"), \"labels\"] = 2\n","data.loc[(data[\"labels\"] == \"camping\"), \"labels\"] = 3\n","data.loc[(data[\"labels\"] == \"medical\"), \"labels\"] = 4\n","data.loc[(data[\"labels\"] == \"pocket_ball\"), \"labels\"] = 5\n","data.loc[(data[\"labels\"] == \"health_yoga\"), \"labels\"] = 6\n","data"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1LjdJux5z1Cj"},"outputs":[],"source":["data =data.dropna(axis=0)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1685863538689,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"l0tpx6AZ0M5x","outputId":"006ecc45-312b-4c67-b710-e850ded187f7"},"outputs":[{"data":{"text/plain":["4800"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["len(data)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zoViSz2AxFxo"},"outputs":[],"source":["data_shuffled = data.sample(frac=1).reset_index(drop=True)\n","train = data_shuffled[:4400]\n","test = data_shuffled[:400]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jmkseKq4nBYD"},"outputs":[],"source":["#문장 앞 뒤마다 [CLS], [SEP] 붙여주기\n","#labels를 따로 저장하기\n","sentences = [\"[CLS] \" + str(s) + \" [SEP]\" for s in train['objects']]\n","labels = train['labels'].values"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YVc-O2QczXjK"},"outputs":[],"source":["labels = labels.astype('int')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1685863538689,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"en9EzNLSuXk-","outputId":"23a3254f-7eb5-4b68-d407-4edc7ebb12ec"},"outputs":[{"data":{"text/plain":["array([1, 0, 5, ..., 6, 0, 6])"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["labels"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["12a08efe269c4e488e301cd20a2559ae","658654b467424e0ca34f94d5e2b95128","c182a423e5034fa5ae30aec2d7a3ea37","3f59f74b9c17470b96eb652aa57ab676","6a02ebe679cb43efbdce25273aed5a5a","afa86277a91a41f9a0b9f1d2f5c4f461","d0c74a485fe847579c298d8d2bc1924e","646fce2a53fc48faa8a4ee9efdc1b45f","bc6fdcad0f944043b51f0450634952f1","4cec2b3cd2484ea68ca62b1333d09a3a","73b04ef0f95e40c798fa179bbadd0980","ecd10a79f9a042409a83098041ed7bc1","3f23a2653832427db06108e649484560","e4329e9c97d94c8cae0c90cac5c937dc","9eff30f59f5347f19c55a4be46a6a27f","9bef91a1da37476aa4431dc4f4d41074","1669988b99cb4590af6bae2117a2c609","44ccacd82e8a427fab3e88eccdbecd84","f517bbd17a3d4c45b4cd980f26405e6c","ea53a4769a124d65808d40603ea8e46b","6dccd06ad3594cf2b101c37a5258f8b7","724fa3ed73034a0b8b7e03706748ed5f","bc944332956147cba1acc496ea884dcf","cec0fb64db7f47689a05216f08c1480a","d34903ae1630437e97af69b2c849162b","701ad4a1856c4e4ca08b1240136d785c","4bee95bb000e4c69bcafde0403c1723f","248e2e5864db4653a1d88d2220652794","af328c8b343649aa84f3ae2fef9d4926","7b0b895deac540bfb76e68cfaa904e99","6538c5e15c2844c38293b4843cdbc735","6ecd3764c0264345b03be8382bf60fac","a0395378682f4d4faafabbaf7a460956"]},"executionInfo":{"elapsed":2791,"status":"ok","timestamp":1685863541476,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"U9sQyNuwnF5p","outputId":"4b59106f-0876-430f-e0dc-d88df217c00f"},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"12a08efe269c4e488e301cd20a2559ae","version_major":2,"version_minor":0},"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/996k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ecd10a79f9a042409a83098041ed7bc1","version_major":2,"version_minor":0},"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/29.0 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bc944332956147cba1acc496ea884dcf","version_major":2,"version_minor":0},"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/625 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"}],"source":["#서브워드 토크나이저 : WordPiece\n","tokenizer = BertTokenizer.from_pretrained(\"bert-base-multilingual-cased\", do_lower_case=False)\n","tokenized_texts = [tokenizer.tokenize(s) for s in sentences]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_VZCJlfsnNpX"},"outputs":[],"source":["#문장 최대 시퀀스 설정해 정수 인코딩과 제로패딩 수행\n","\n","MAX_LEN = 128 #최대 시퀀스 길이 설정\n","input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1685863541476,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"0iUegjgqqnX5","outputId":"28b64e03-642c-4a01-f313-d67e7f00439a"},"outputs":[{"data":{"text/plain":["array([   101,   9448,  90927, 119209,  27506,   9524,  47289,   9067,\n","        17196,  28000,    102,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0,\n","            0,      0,      0,      0,      0,      0,      0,      0])"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["input_ids[0] #출력해보기"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WGp63zLVnQyY"},"outputs":[],"source":["#어텐션 마스크\n","# : 0값 가지는 패딩 토큰에 대해 어텐션 연산 불필요하게 수행하지 않도록 단어와 패딩토큰 구분\n","# (패딩이면 0, 아니면 1)\n","attention_masks = []\n","\n","for seq in input_ids:\n","    seq_mask = [float(i>0) for i in seq]\n","    attention_masks.append(seq_mask)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1685863541477,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"9s3TF4pZq1HE","outputId":"ca309ffe-5f52-4a94-d269-85c86851cec9"},"outputs":[{"name":"stdout","output_type":"stream","text":["[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n"]}],"source":["print(attention_masks[0]) #어텐션 마스크 생성 확인"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xmyYqqipnTKL"},"outputs":[],"source":["#train set을 train, val로 분리하기\n","train_inputs, validation_inputs, train_labels, validation_labels = train_test_split(input_ids,\n","                                                                                    labels,\n","                                                                                    random_state=2000,\n","                                                                                    test_size=0.1)\n","\n","train_masks, validation_masks, _, _ = train_test_split(attention_masks,\n","                                                       input_ids,\n","                                                       random_state=2000,\n","                                                       test_size=0.1)\n","\n","train_inputs = torch.tensor(train_inputs)\n","train_labels = torch.tensor(train_labels)\n","train_masks = torch.tensor(train_masks)\n","validation_inputs = torch.tensor(validation_inputs)\n","validation_labels = torch.tensor(validation_labels)\n","validation_masks = torch.tensor(validation_masks)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qFHdD20SnVra"},"outputs":[],"source":["#배치사이즈 설정\n","#입력 데이터, 어텐션마스크, 라벨을 하나의 데이터로 묶어 train_dataloader, validation_dataloader 입력데이터로 생성해줌\n","batch_size = 32\n","\n","train_data = TensorDataset(train_inputs, train_masks, train_labels)\n","train_sampler = RandomSampler(train_data)\n","train_dataloader = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)\n","\n","validation_data = TensorDataset(validation_inputs, validation_masks, validation_labels)\n","validation_sampler = SequentialSampler(validation_data)\n","validation_dataloader = DataLoader(validation_data, sampler=validation_sampler, batch_size=batch_size)"]},{"cell_type":"markdown","metadata":{"id":"6KVFX3eRrJ6O"},"source":["# test set 전처리"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1685863542085,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"sAKbi6pMnYsk","outputId":"e2789508-2ada-4eb5-cbca-f9b5ad243189"},"outputs":[{"name":"stderr","output_type":"stream","text":["<ipython-input-19-c71625bde7ab>:6: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\n","Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n","  test_labels=np.vstack(test_labels).astype(np.float)\n"]}],"source":["# [CLS] + 문장 + [SEP]\n","test_sentences = [\"[CLS] \" + str(sentence) + \" [SEP]\" for sentence in test['objects']]\n","\n","# 라벨 데이터\n","test_labels = test['labels'].values\n","test_labels=np.vstack(test_labels).astype(np.float)\n","# Word 토크나이저 토큰화\n","tokenizer = BertTokenizer.from_pretrained('bert-base-multilingual-cased', do_lower_case=False)\n","test_tokenized_texts = [tokenizer.tokenize(sent) for sent in test_sentences]\n","\n","# 시퀀스 설정 및 정수 인덱스 변환 & 패딩\n","MAX_LEN = 128\n","test_input_ids = [tokenizer.convert_tokens_to_ids(x) for x in test_tokenized_texts]\n","test_input_ids = pad_sequences(test_input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","# 어텐션 마스크\n","test_attention_masks = []\n","for seq in test_input_ids:\n","    test_seq_mask = [float(i>0) for i in seq]\n","    test_attention_masks.append(test_seq_mask)\n","\n","# 파이토치 텐서로 변환\n","test_inputs = torch.tensor(test_input_ids)\n","test_labels = torch.tensor(test_labels)\n","test_masks = torch.tensor(test_attention_masks)\n","\n","# 배치 사이즈 설정 및 데이터 설정\n","batch_size = 32\n","test_data = TensorDataset(test_inputs, test_masks, test_labels)\n","test_sampler = RandomSampler(test_data)\n","test_dataloader = DataLoader(test_data, sampler=test_sampler, batch_size=batch_size)"]},{"cell_type":"markdown","metadata":{"id":"h5EtcnSNr2Qv"},"source":["# BERT 모델 불러오기"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1685863542086,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"MzgxWMmRnah0","outputId":"ff238da6-722c-465b-84d6-cd4939635322"},"outputs":[{"name":"stdout","output_type":"stream","text":["There are 1 GPU(s) available.\n","We will use the GPU: Tesla T4\n"]}],"source":["if torch.cuda.is_available():\n","    device = torch.device(\"cuda\")\n","    print('There are %d GPU(s) available.' % torch.cuda.device_count())\n","    print('We will use the GPU:', torch.cuda.get_device_name(0))\n","else:\n","    device = torch.device(\"cpu\")\n","    print('No GPU available, using the CPU instead.')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":962,"referenced_widgets":["a660f4d90cc54aa08b975df0bf34a395","21ab21ed1f984e979abd91566a020a67","af4270451e6e4f57a88172812c47fd47","4752bd3ec662425d89e8245f33550c7e","4c55b319459e43b28050d02ac6351dcb","149e575206c847309e3a6ba001fcb816","5eb6fef8b7cc4f928205c091df342d7f","feac1f114e1a4086814d8019c33f47dd","89e3e7b818da45f19beb567fbedd751d","b2a145be1e6946e9a568e02ef8b3cfed","a17f67b2a9934fb4bd62c3f17d66eb51"]},"executionInfo":{"elapsed":8530,"status":"ok","timestamp":1685863551922,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"RSfd_X6wnb1v","outputId":"584a4cdc-646a-4cf6-e238-7ea074e01481"},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a660f4d90cc54aa08b975df0bf34a395","version_major":2,"version_minor":0},"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/714M [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"name":"stderr","output_type":"stream","text":["Some weights of the model checkpoint at bert-base-multilingual-cased were not used when initializing BertForSequenceClassification: ['cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias']\n","- This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-multilingual-cased and are newly initialized: ['classifier.weight', 'classifier.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"data":{"text/plain":["BertForSequenceClassification(\n","  (bert): BertModel(\n","    (embeddings): BertEmbeddings(\n","      (word_embeddings): Embedding(119547, 768, padding_idx=0)\n","      (position_embeddings): Embedding(512, 768)\n","      (token_type_embeddings): Embedding(2, 768)\n","      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      (dropout): Dropout(p=0.1, inplace=False)\n","    )\n","    (encoder): BertEncoder(\n","      (layer): ModuleList(\n","        (0-11): 12 x BertLayer(\n","          (attention): BertAttention(\n","            (self): BertSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): BertSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): BertIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): BertOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","      )\n","    )\n","    (pooler): BertPooler(\n","      (dense): Linear(in_features=768, out_features=768, bias=True)\n","      (activation): Tanh()\n","    )\n","  )\n","  (dropout): Dropout(p=0.1, inplace=False)\n","  (classifier): Linear(in_features=768, out_features=7, bias=True)\n",")"]},"execution_count":21,"metadata":{},"output_type":"execute_result"}],"source":["#pretrained 된 BERT 모델 불러오기\n","model = BertForSequenceClassification.from_pretrained(\"bert-base-multilingual-cased\", num_labels=7)\n","model.cuda()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1685863551922,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"UD_MUFu8nd7A","outputId":"f80a45e6-9042-4992-ee0a-dc35992a4778"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]}],"source":["# 옵티마이저\n","optimizer = AdamW(model.parameters(),\n","                  lr = 2e-5, # 학습률(learning rate)\n","                  eps = 1e-8\n","                )\n","\n","# 에폭수\n","epochs = 100\n","\n","# 총 훈련 스텝 : 배치반복 횟수 * 에폭\n","total_steps = len(train_dataloader) * epochs\n","\n","# 스케줄러 생성\n","scheduler = get_linear_schedule_with_warmup(optimizer,\n","                                            num_warmup_steps = 0,\n","                                            num_training_steps = total_steps)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Rnm-XKf0nfmO"},"outputs":[],"source":["# 정확도 계산 함수\n","def flat_accuracy(preds, labels):\n","\n","    pred_flat = np.argmax(preds, axis=1).flatten()\n","    labels_flat = labels.flatten()\n","\n","    return np.sum(pred_flat == labels_flat) / len(labels_flat)\n","\n","\n","# 시간 표시 함수\n","def format_time(elapsed):\n","\n","    # 반올림\n","    elapsed_rounded = int(round((elapsed)))\n","\n","    # hh:mm:ss으로 형태 변경\n","    return str(datetime.timedelta(seconds=elapsed_rounded))"]},{"cell_type":"markdown","metadata":{"id":"2pLV8YTTr_e8"},"source":["# 모델 학습하기"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7840116,"status":"ok","timestamp":1685871392037,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"OYJsMrPWngDf","outputId":"bb46eaa2-dd88-4b8e-c186-99bac6382660"},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","======== Epoch 1 / 100 ========\n","Training...\n","\n","  Average training loss: 1.27\n","  Training epcoh took: 0:01:14\n","\n","Running Validation...\n","  Accuracy: 0.72\n","  Validation took: 0:00:03\n","\n","======== Epoch 2 / 100 ========\n","Training...\n","\n","  Average training loss: 0.92\n","  Training epcoh took: 0:01:14\n","\n","Running Validation...\n","  Accuracy: 0.72\n","  Validation took: 0:00:03\n","\n","======== Epoch 3 / 100 ========\n","Training...\n","\n","  Average training loss: 0.88\n","  Training epcoh took: 0:01:15\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 4 / 100 ========\n","Training...\n","\n","  Average training loss: 0.86\n","  Training epcoh took: 0:01:15\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 5 / 100 ========\n","Training...\n","\n","  Average training loss: 0.83\n","  Training epcoh took: 0:01:15\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 6 / 100 ========\n","Training...\n","\n","  Average training loss: 0.82\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 7 / 100 ========\n","Training...\n","\n","  Average training loss: 0.81\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 8 / 100 ========\n","Training...\n","\n","  Average training loss: 0.79\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 9 / 100 ========\n","Training...\n","\n","  Average training loss: 0.78\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 10 / 100 ========\n","Training...\n","\n","  Average training loss: 0.77\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 11 / 100 ========\n","Training...\n","\n","  Average training loss: 0.76\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 12 / 100 ========\n","Training...\n","\n","  Average training loss: 0.75\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 13 / 100 ========\n","Training...\n","\n","  Average training loss: 0.75\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 14 / 100 ========\n","Training...\n","\n","  Average training loss: 0.74\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 15 / 100 ========\n","Training...\n","\n","  Average training loss: 0.74\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 16 / 100 ========\n","Training...\n","\n","  Average training loss: 0.73\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 17 / 100 ========\n","Training...\n","\n","  Average training loss: 0.73\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 18 / 100 ========\n","Training...\n","\n","  Average training loss: 0.73\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 19 / 100 ========\n","Training...\n","\n","  Average training loss: 0.72\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 20 / 100 ========\n","Training...\n","\n","  Average training loss: 0.72\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 21 / 100 ========\n","Training...\n","\n","  Average training loss: 0.72\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 22 / 100 ========\n","Training...\n","\n","  Average training loss: 0.71\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 23 / 100 ========\n","Training...\n","\n","  Average training loss: 0.71\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 24 / 100 ========\n","Training...\n","\n","  Average training loss: 0.71\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.73\n","  Validation took: 0:00:03\n","\n","======== Epoch 25 / 100 ========\n","Training...\n","\n","  Average training loss: 0.71\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 26 / 100 ========\n","Training...\n","\n","  Average training loss: 0.70\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 27 / 100 ========\n","Training...\n","\n","  Average training loss: 0.70\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 28 / 100 ========\n","Training...\n","\n","  Average training loss: 0.70\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 29 / 100 ========\n","Training...\n","\n","  Average training loss: 0.70\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 30 / 100 ========\n","Training...\n","\n","  Average training loss: 0.70\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 31 / 100 ========\n","Training...\n","\n","  Average training loss: 0.70\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 32 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 33 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 34 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 35 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 36 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 37 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 38 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 39 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 40 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 41 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.74\n","  Validation took: 0:00:03\n","\n","======== Epoch 42 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 43 / 100 ========\n","Training...\n","\n","  Average training loss: 0.69\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 44 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 45 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 46 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 47 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 48 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 49 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 50 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 51 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 52 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 53 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 54 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 55 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 56 / 100 ========\n","Training...\n","\n","  Average training loss: 0.68\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 57 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 58 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 59 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 60 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 61 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 62 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 63 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 64 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 65 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 66 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 67 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 68 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 69 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 70 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 71 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 72 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 73 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 74 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 75 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 76 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 77 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 78 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 79 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 80 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 81 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 82 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 83 / 100 ========\n","Training...\n","\n","  Average training loss: 0.67\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 84 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 85 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 86 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 87 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 88 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 89 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 90 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 91 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 92 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 93 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 94 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 95 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 96 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 97 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 98 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.75\n","  Validation took: 0:00:03\n","\n","======== Epoch 99 / 100 ========\n","Training...\n","\n","  Average training loss: 0.66\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","======== Epoch 100 / 100 ========\n","Training...\n","\n","  Average training loss: 0.65\n","  Training epcoh took: 0:01:16\n","\n","Running Validation...\n","  Accuracy: 0.76\n","  Validation took: 0:00:03\n","\n","Training complete!\n"]}],"source":["#랜덤시드 고정\n","seed_val = 42\n","random.seed(seed_val)\n","np.random.seed(seed_val)\n","torch.manual_seed(seed_val)\n","torch.cuda.manual_seed_all(seed_val)\n","\n","#그래디언트 초기화\n","model.zero_grad()\n","\n","# 학습\n","for epoch_i in range(0, epochs):\n","\n","    # ========================================\n","    #               Training\n","    # ========================================\n","\n","    print(\"\")\n","    print('======== Epoch {:} / {:} ========'.format(epoch_i + 1, epochs))\n","    print('Training...')\n","\n","    # 시작 시간 설정\n","    t0 = time.time()\n","\n","    # 로스 초기화\n","    total_loss = 0\n","\n","    # 훈련모드로 변경\n","    model.train()\n","\n","    # 데이터로더에서 배치만큼 반복하여 가져옴\n","    for step, batch in enumerate(train_dataloader):\n","        # 경과 정보 표시\n","        if step % 500 == 0 and not step == 0:\n","            elapsed = format_time(time.time() - t0)\n","            print('  Batch {:>5,}  of  {:>5,}.    Elapsed: {:}.'.format(step, len(train_dataloader), elapsed))\n","\n","        # 배치를 GPU에 넣음\n","        batch = tuple(t.to(device) for t in batch)\n","\n","        # 배치에서 데이터 추출\n","        b_input_ids, b_input_mask, b_labels = batch\n","\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask,\n","                        labels=b_labels)\n","\n","        # 로스 구함\n","        loss = outputs[0]\n","\n","        # 총 로스 계산\n","        total_loss += loss.item()\n","\n","        # Backward 수행으로 그래디언트 계산\n","        loss.backward()\n","\n","        # 그래디언트 클리핑\n","        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n","\n","        # 그래디언트를 통해 가중치 파라미터 업데이트\n","        optimizer.step()\n","\n","        # 스케줄러로 학습률 감소\n","        scheduler.step()\n","\n","        # 그래디언트 초기화\n","        model.zero_grad()\n","\n","    # 평균 로스 계산\n","    avg_train_loss = total_loss / len(train_dataloader)\n","\n","    print(\"\")\n","    print(\"  Average training loss: {0:.2f}\".format(avg_train_loss))\n","    print(\"  Training epcoh took: {:}\".format(format_time(time.time() - t0)))\n","\n","    # ========================================\n","    #               Validation\n","    # ========================================\n","\n","    print(\"\")\n","    print(\"Running Validation...\")\n","\n","    #시작 시간 설정\n","    t0 = time.time()\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 변수 초기화\n","    eval_loss, eval_accuracy = 0, 0\n","    nb_eval_steps, nb_eval_examples = 0, 0\n","\n","    # 데이터로더에서 배치만큼 반복하여 가져옴\n","    for batch in validation_dataloader:\n","        # 배치를 GPU에 넣음\n","        batch = tuple(t.to(device) for t in batch)\n","\n","        # 배치에서 데이터 추출\n","        b_input_ids, b_input_mask, b_labels = batch\n","\n","        # 그래디언트 계산 안함\n","        with torch.no_grad():\n","            # Forward 수행\n","            outputs = model(b_input_ids,\n","                            token_type_ids=None,\n","                            attention_mask=b_input_mask)\n","\n","        # 로스 구함\n","        logits = outputs[0]\n","\n","        # CPU로 데이터 이동\n","        logits = logits.detach().cpu().numpy()\n","        label_ids = b_labels.to('cpu').numpy()\n","\n","        # 출력 로짓과 라벨을 비교하여 정확도 계산\n","        tmp_eval_accuracy = flat_accuracy(logits, label_ids)\n","        eval_accuracy += tmp_eval_accuracy\n","        nb_eval_steps += 1\n","\n","    print(\"  Accuracy: {0:.2f}\".format(eval_accuracy/nb_eval_steps))\n","    print(\"  Validation took: {:}\".format(format_time(time.time() - t0)))\n","\n","print(\"\")\n","print(\"Training complete!\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4luUBSbh2Xk8"},"outputs":[],"source":["torch.save(model, 'model_epoch30_all.pth')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KVgnKp0O5hBO"},"outputs":[],"source":["torch.save(model.state_dict(), 'model_weights_epoch30_all.pth')"]},{"cell_type":"markdown","metadata":{"id":"jc5xxHSfsEcJ"},"source":["# 테스트 셋 평가"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"85A51wNM2nxy"},"outputs":[],"source":["model = torch.load('model_epoch30_.pth')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2813,"status":"ok","timestamp":1685871996865,"user":{"displayName":"대학혁신","userId":"07131620507606764313"},"user_tz":-540},"id":"EK96hI_Dntl3","outputId":"c2439a9f-d07f-4bc9-d137-82c77c8feb63"},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","Accuracy: 0.75\n","Test took: 0:00:03\n"]}],"source":["_#시작 시간 설정\n","t0 = time.time()\n","\n","# 평가모드로 변경\n","model.eval()\n","\n","# 변수 초기화\n","eval_loss, eval_accuracy = 0, 0\n","nb_eval_steps, nb_eval_examples = 0, 0\n","\n","# 데이터로더에서 배치만큼 반복하여 가져옴\n","for step, batch in enumerate(test_dataloader):\n","    # 경과 정보 표시\n","    if step % 100 == 0 and not step == 0:\n","        elapsed = format_time(time.time() - t0)\n","        print('  Batch {:>5,}  of  {:>5,}.    Elapsed: {:}.'.format(step, len(test_dataloader), elapsed))\n","\n","    # 배치를 GPU에 넣음\n","    batch = tuple(t.to(device) for t in batch)\n","\n","    # 배치에서 데이터 추출\n","    b_input_ids, b_input_mask, b_labels = batch\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","    label_ids = b_labels.to('cpu').numpy()\n","\n","    # 출력 로짓과 라벨을 비교하여 정확도 계산\n","    tmp_eval_accuracy = flat_accuracy(logits, label_ids)\n","    eval_accuracy += tmp_eval_accuracy\n","    nb_eval_steps += 1\n","\n","print(\"\")\n","print(\"Accuracy: {0:.2f}\".format(eval_accuracy/nb_eval_steps))\n","print(\"Test took: {:}\".format(format_time(time.time() - t0)))"]},{"cell_type":"markdown","metadata":{"id":"_q-RzXCKsJFD"},"source":["# 새로운 활동 분류 테스트"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hcYfu9V7n1Tu"},"outputs":[],"source":["# 입력 데이터 변환\n","def convert_input_data(sentences):\n","\n","    # BERT의 토크나이저로 문장을 토큰으로 분리\n","    tokenized_texts = [tokenizer.tokenize(sent) for sent in sentences]\n","\n","    # 입력 토큰의 최대 시퀀스 길이\n","    MAX_LEN = 128\n","\n","    # 토큰을 숫자 인덱스로 변환\n","    input_ids = [tokenizer.convert_tokens_to_ids(x) for x in tokenized_texts]\n","\n","    # 문장을 MAX_LEN 길이에 맞게 자르고, 모자란 부분을 패딩 0으로 채움\n","    input_ids = pad_sequences(input_ids, maxlen=MAX_LEN, dtype=\"long\", truncating=\"post\", padding=\"post\")\n","\n","    # 어텐션 마스크 초기화\n","    attention_masks = []\n","\n","    # 어텐션 마스크를 패딩이 아니면 1, 패딩이면 0으로 설정\n","    # 패딩 부분은 BERT 모델에서 어텐션을 수행하지 않아 속도 향상\n","    for seq in input_ids:\n","        seq_mask = [float(i>0) for i in seq]\n","        attention_masks.append(seq_mask)\n","\n","    # 데이터를 파이토치의 텐서로 변환\n","    inputs = torch.tensor(input_ids)\n","    masks = torch.tensor(attention_masks)\n","    return inputs, masks\n","\n","def test_sentences(sentences):\n","\n","    # 평가모드로 변경\n","    model.eval()\n","\n","    # 문장을 입력 데이터로 변환\n","    inputs, masks = convert_input_data(sentences)\n","\n","    # 데이터를 GPU에 넣음\n","    b_input_ids = inputs.to(device)\n","    b_input_mask = masks.to(device)\n","\n","    # 그래디언트 계산 안함\n","    with torch.no_grad():\n","        # Forward 수행\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    # 로스 구함\n","    logits = outputs[0]\n","\n","    # CPU로 데이터 이동\n","    logits = logits.detach().cpu().numpy()\n","\n","    return logits"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FlyI386HsQk-"},"outputs":[],"source":["logits = test_sentences(['__'])\n","print(logits)\n","\n","if np.argmax(logits) == 0 :\n","    print(\"연애 관련 대화\")\n","elif np.argmax(logits) == 1:\n","    print(\"일상 대화\")\n","elif np.argmax(logits) == 2 :\n","    print(\"일상 대화\")\n","elif np.argmax(logits) == 3 :\n","    print(\"일상 대화\")\n","elif np.argmax(logits) == 4 :\n","    print(\"일상 대화\")\n","elif np.argmax(logits) == 5 :\n","    print(\"일상 대화\")\n","elif np.argmax(logits) == 6 :\n","    print(\"일상 대화\")"]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1ocrrKw4VI9dApzrsk-q8158Ul9zsAJS_","timestamp":1686043488102}],"authorship_tag":"ABX9TyPk9T4si1gf1X5tVQcpjL77"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"12a08efe269c4e488e301cd20a2559ae":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_658654b467424e0ca34f94d5e2b95128","IPY_MODEL_c182a423e5034fa5ae30aec2d7a3ea37","IPY_MODEL_3f59f74b9c17470b96eb652aa57ab676"],"layout":"IPY_MODEL_6a02ebe679cb43efbdce25273aed5a5a"}},"149e575206c847309e3a6ba001fcb816":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1669988b99cb4590af6bae2117a2c609":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"21ab21ed1f984e979abd91566a020a67":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_149e575206c847309e3a6ba001fcb816","placeholder":"​","style":"IPY_MODEL_5eb6fef8b7cc4f928205c091df342d7f","value":"Downloading pytorch_model.bin: 100%"}},"248e2e5864db4653a1d88d2220652794":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3f23a2653832427db06108e649484560":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1669988b99cb4590af6bae2117a2c609","placeholder":"​","style":"IPY_MODEL_44ccacd82e8a427fab3e88eccdbecd84","value":"Downloading (…)okenizer_config.json: 100%"}},"3f59f74b9c17470b96eb652aa57ab676":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4cec2b3cd2484ea68ca62b1333d09a3a","placeholder":"​","style":"IPY_MODEL_73b04ef0f95e40c798fa179bbadd0980","value":" 996k/996k [00:00&lt;00:00, 4.66MB/s]"}},"44ccacd82e8a427fab3e88eccdbecd84":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4752bd3ec662425d89e8245f33550c7e":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b2a145be1e6946e9a568e02ef8b3cfed","placeholder":"​","style":"IPY_MODEL_a17f67b2a9934fb4bd62c3f17d66eb51","value":" 714M/714M [00:01&lt;00:00, 496MB/s]"}},"4bee95bb000e4c69bcafde0403c1723f":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4c55b319459e43b28050d02ac6351dcb":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4cec2b3cd2484ea68ca62b1333d09a3a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5eb6fef8b7cc4f928205c091df342d7f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"646fce2a53fc48faa8a4ee9efdc1b45f":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6538c5e15c2844c38293b4843cdbc735":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"658654b467424e0ca34f94d5e2b95128":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_afa86277a91a41f9a0b9f1d2f5c4f461","placeholder":"​","style":"IPY_MODEL_d0c74a485fe847579c298d8d2bc1924e","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"6a02ebe679cb43efbdce25273aed5a5a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6dccd06ad3594cf2b101c37a5258f8b7":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6ecd3764c0264345b03be8382bf60fac":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"701ad4a1856c4e4ca08b1240136d785c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6ecd3764c0264345b03be8382bf60fac","placeholder":"​","style":"IPY_MODEL_a0395378682f4d4faafabbaf7a460956","value":" 625/625 [00:00&lt;00:00, 60.9kB/s]"}},"724fa3ed73034a0b8b7e03706748ed5f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"73b04ef0f95e40c798fa179bbadd0980":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7b0b895deac540bfb76e68cfaa904e99":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89e3e7b818da45f19beb567fbedd751d":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9bef91a1da37476aa4431dc4f4d41074":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9eff30f59f5347f19c55a4be46a6a27f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6dccd06ad3594cf2b101c37a5258f8b7","placeholder":"​","style":"IPY_MODEL_724fa3ed73034a0b8b7e03706748ed5f","value":" 29.0/29.0 [00:00&lt;00:00, 2.57kB/s]"}},"a0395378682f4d4faafabbaf7a460956":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a17f67b2a9934fb4bd62c3f17d66eb51":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a660f4d90cc54aa08b975df0bf34a395":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_21ab21ed1f984e979abd91566a020a67","IPY_MODEL_af4270451e6e4f57a88172812c47fd47","IPY_MODEL_4752bd3ec662425d89e8245f33550c7e"],"layout":"IPY_MODEL_4c55b319459e43b28050d02ac6351dcb"}},"af328c8b343649aa84f3ae2fef9d4926":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"af4270451e6e4f57a88172812c47fd47":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_feac1f114e1a4086814d8019c33f47dd","max":714314041,"min":0,"orientation":"horizontal","style":"IPY_MODEL_89e3e7b818da45f19beb567fbedd751d","value":714314041}},"afa86277a91a41f9a0b9f1d2f5c4f461":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b2a145be1e6946e9a568e02ef8b3cfed":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bc6fdcad0f944043b51f0450634952f1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bc944332956147cba1acc496ea884dcf":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cec0fb64db7f47689a05216f08c1480a","IPY_MODEL_d34903ae1630437e97af69b2c849162b","IPY_MODEL_701ad4a1856c4e4ca08b1240136d785c"],"layout":"IPY_MODEL_4bee95bb000e4c69bcafde0403c1723f"}},"c182a423e5034fa5ae30aec2d7a3ea37":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_646fce2a53fc48faa8a4ee9efdc1b45f","max":995526,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bc6fdcad0f944043b51f0450634952f1","value":995526}},"cec0fb64db7f47689a05216f08c1480a":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_248e2e5864db4653a1d88d2220652794","placeholder":"​","style":"IPY_MODEL_af328c8b343649aa84f3ae2fef9d4926","value":"Downloading (…)lve/main/config.json: 100%"}},"d0c74a485fe847579c298d8d2bc1924e":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d34903ae1630437e97af69b2c849162b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7b0b895deac540bfb76e68cfaa904e99","max":625,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6538c5e15c2844c38293b4843cdbc735","value":625}},"e4329e9c97d94c8cae0c90cac5c937dc":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f517bbd17a3d4c45b4cd980f26405e6c","max":29,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ea53a4769a124d65808d40603ea8e46b","value":29}},"ea53a4769a124d65808d40603ea8e46b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ecd10a79f9a042409a83098041ed7bc1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3f23a2653832427db06108e649484560","IPY_MODEL_e4329e9c97d94c8cae0c90cac5c937dc","IPY_MODEL_9eff30f59f5347f19c55a4be46a6a27f"],"layout":"IPY_MODEL_9bef91a1da37476aa4431dc4f4d41074"}},"f517bbd17a3d4c45b4cd980f26405e6c":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"feac1f114e1a4086814d8019c33f47dd":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}}}}},"nbformat":4,"nbformat_minor":0}